<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>电脑摄像头调用</title>
</head>

<body>
    <video id="video" style="width:50% ;height: 50%;border-radius: 8px; margin: 30px auto;display: block;box-sizing: border-box;" muted="muted">
    </video>
</body>
<script>
'use strict';
var video = document.getElementsByTagName('video')[0];
console.log(video);
var URL = window.URL || window.webkitURL;
console.log(URL);
navigator.webkitGetUserMedia({
    video: true,
    audio: true
}, function(stream) {
    video.src = URL.createObjectURL(stream);
    // video.src = HTMLMediaElement.srcObject(stream);
    video.play();
}, function(error) {
    alert(error.name || error)
});

/**
 * 判断浏览器是否显示当前页面
 * 如果不是则关闭摄像头
 */
var hiddenProperty = 'hidden' in document ? 'hidden' : 'webkitHidden' in document ? 'webkitHidden' :
    'mozHidden' in document ? 'mozHidden' :
    null;

var visibilityChangeEvent = hiddenProperty.replace(/hidden/i, 'visibilitychange');
var onVisibilityChahiddenPropertynge = function() {
    if (!document[hiddenProperty]) {
        console.log('页面非激活');
    } else {
        console.log('页面激活');
    }
}
document.addEventListener(visibilityChangeEvent, onVisibilityChahiddenPropertynge);
</script>

</html>